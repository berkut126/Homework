DROP TABLE IF EXISTS TASKS;
DROP TABLE IF EXISTS HOMEWORK;
DROP TABLE IF EXISTS LESSONS;
DROP TABLE IF EXISTS TIMETABLE;
DROP TABLE IF EXISTS USERS;

CREATE TABLE USERS(
    ID INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    LOGIN VARCHAR(255) NOT NULL UNIQUE,
    FIRST_NAME VARCHAR(40) NOT NULL,
    LAST_NAME VARCHAR(40) NOT NULL,
    PASSWORD VARCHAR(64) NOT NULL,
    USER_GROUP ENUM('Admin', 'User') NOT NULL DEFAULT 'User'
);

INSERT INTO USERS VALUES ( 1, 'nnn', 'Andrey', 'Ivanov', 'hghghghg', 'Admin');
INSERT INTO USERS VALUES ( 2, 'aaa', 'Andrey', 'Ivanov', 'hghghghg', 'User');

CREATE TABLE TIMETABLE(
    ID INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    DAY ENUM ('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday') NOT NULL,
    TIME TIME NOT NULL,
    CONSTRAINT TIMETABLE_UNIQUE_LESSON UNIQUE(DAY, TIME)
);

INSERT INTO TIMETABLE VALUES ( 1, 'Monday', '10:00');
INSERT INTO TIMETABLE VALUES ( 2, 'Monday', '10:30');

CREATE TABLE LESSONS(
    ID INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    NAME VARCHAR(20) NOT NULL,
    WHEN INTEGER NOT NULL,
    WHOSE INTEGER NOT NULL,
    FOREIGN KEY (WHEN) REFERENCES TIMETABLE(ID),
    FOREIGN KEY (WHOSE) REFERENCES USERS(ID)
);

INSERT INTO LESSONS VALUES ( 1, 'Math', 1, 1 );
INSERT INTO LESSONS VALUES ( 2, 'Math', 2, 1 );
INSERT INTO LESSONS VALUES ( 3, 'Comms', 1, 2 );
INSERT INTO LESSONS VALUES ( 4, 'Comms', 2, 2 );

CREATE TABLE HOMEWORK(
    ID INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
    TASK VARCHAR(255) NOT NULL,
    DUE DATE NOT NULL
);

INSERT INTO HOMEWORK VALUES ( 1, 'LIM', '2020-12-12' );
INSERT INTO HOMEWORK VALUES ( 2, 'TRAN', '2020-11-11' );

CREATE TABLE TASKS(
    SUBJECT INTEGER NOT NULL,
    TASK INTEGER NOT NULL,
    FOREIGN KEY (SUBJECT) REFERENCES LESSONS(ID),
    FOREIGN KEY (TASK) REFERENCES HOMEWORK(ID)
);

INSERT INTO TASKS VALUES ( 1, 1 );
INSERT INTO TASKS VALUES ( 2, 1 );
INSERT INTO TASKS VALUES ( 3, 2 );
INSERT INTO TASKS VALUES ( 4, 2 );